<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Employee Onboarding</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f7fb; margin:0; }
    .wrap { max-width: 600px; margin:40px auto; padding:20px; background:#fff;
            border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
    h1 { font-size:20px; margin-bottom:15px; }
    label { display:block; margin:12px 0 6px; font-weight:bold; }
    input { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; }
    button { margin-top:12px; padding:10px 16px; border:none; border-radius:6px;
             background:#0b74de; color:#fff; cursor:pointer; }
    button:disabled { background:#ccc; cursor:not-allowed; }
    .hidden { display:none; }
    .msg { margin-top:8px; font-size:14px; }
    .success { color:green; }
    .error { color:#b00020; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Login with Email OTP</h1>

    <!-- Page 1: Login -->
    <div id="page-login">
      <label for="name">Full Name</label>
      <input type="text" id="name">

      <label for="phone">Mobile Number</label>
      <input type="text" id="phone">

      <label for="email">Email</label>
      <input type="email" id="email">

      <button id="btnSendEmailOtp">Send OTP</button>
      <div id="sendMsg" class="msg"></div>

      <div id="otpSection" class="hidden">
        <label for="emailOtp">Enter OTP</label>
        <input type="text" id="emailOtp" maxlength="6" placeholder="6-digit OTP">
        <button id="btnVerifyEmailOtp">Verify OTP</button>
        <div id="verifyMsg" class="msg"></div>
      </div>
    </div>

    <!-- Page 2: Aadhaar (demo only) -->
    <div id="page-aadhaar" class="hidden">
      <h2>Step 2: Aadhaar Verification</h2>
      <label>Aadhaar Number</label>
      <input type="text" id="aadhaar" maxlength="12" placeholder="Enter Aadhaar">
      <button onclick="alert('Aadhaar verification only works with backend UIDAI API. This is a demo.')">Verify Aadhaar</button>
    </div>
  </div>

  <script>
    // üîπ Replace with your Apps Script Web App deployment URL
    const BACKEND_BASE_URL = "https://script.google.com/macros/s/AKfycbzdExvXdD0ZpkhOJ91g8H9uOnyYNbTA9hwoj6-52hHdf-iLL_J9L_5fSRuym5SxVMKLEQ/exec";

    const btnSend = document.getElementById("btnSendEmailOtp");
    const btnVerify = document.getElementById("btnVerifyEmailOtp");
    const sendMsg = document.getElementById("sendMsg");
    const verifyMsg = document.getElementById("verifyMsg");
    const otpSection = document.getElementById("otpSection");

    btnSend.addEventListener("click", async () => {
      const email = document.getElementById("email").value;
      if (!email) { alert("Enter email first"); return; }

      sendMsg.textContent = "Sending OTP...";
      const res = await fetch(BACKEND_BASE_URL, {
        method: "POST",
        body: JSON.stringify({ action: "sendOtp", email }),
        headers: { "Content-Type": "application/json" }
      });
      const data = await res.json();

      if (data.ok) {
        sendMsg.textContent = "OTP sent to " + email;
        sendMsg.className = "msg success";
        otpSection.classList.remove("hidden");
      } else {
        sendMsg.textContent = "Failed to send OTP.";
        sendMsg.className = "msg error";
      }
    });

    btnVerify.addEventListener("click", async () => {
      const email = document.getElementById("email").value;
      const otp = document.getElementById("emailOtp").value;

      verifyMsg.textContent = "Verifying...";
      const res = await fetch(BACKEND_BASE_URL, {
        method: "POST",
        body: JSON.stringify({ action: "verifyOtp", email, otp }),
        headers: { "Content-Type": "application/json" }
      });
      const data = await res.json();

      if (data.ok && data.verified) {
        verifyMsg.textContent = "OTP Verified ‚úÖ";
        verifyMsg.className = "msg success";

        // Go to Aadhaar step
        document.getElementById("page-login").classList.add("hidden");
        document.getElementById("page-aadhaar").classList.remove("hidden");

      } else {
        verifyMsg.textContent = "Invalid OTP ‚ùå";
        verifyMsg.className = "msg error";
      }
    });
  </script>
</body>
</html>

